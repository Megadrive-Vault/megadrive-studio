///////////////////////////////////////////////////////////////////////////////
//
//
//
//
///////////////////////////////////////////////////////////////////////////////
// Includes 
#include "include/mdShared.h"
#include "include/mdProgressStatusBar.h"

///////////////////////////////////////////////////////////////////////////////
// Events
///////////////////////////////////////////////////////////////////////////////

BEGIN_EVENT_TABLE(mdProgressStatusBar, wxStatusBar)
    EVT_SIZE(mdProgressStatusBar::OnSize)    
END_EVENT_TABLE()

///////////////////////////////////////////////////////////////////////////////
// Constructor
///////////////////////////////////////////////////////////////////////////////

mdProgressStatusBar::mdProgressStatusBar(	wxWindow *parent,
										const wxString &text,
										long maxvalue):
										wxStatusBar(parent, -1)
{
	int widths[2]={200,-2};
	m_Gauge=new wxGauge(this,-1,maxvalue);
	m_Gauge->Hide();
	this->SetFieldsCount(2);
	this->SetStatusWidths(2, widths);
	this->SetStatusText(text);	
	m_MaxValue=maxvalue;
}

///////////////////////////////////////////////////////////////////////////////
// Destructor
///////////////////////////////////////////////////////////////////////////////

mdProgressStatusBar::~mdProgressStatusBar()
{
	if(m_Gauge)
		delete(m_Gauge);
}

///////////////////////////////////////////////////////////////////////////////
// Force a resize
///////////////////////////////////////////////////////////////////////////////

void mdProgressStatusBar::SendSizeEvent()
{
	wxRect rect;
    GetFieldRect(1, rect);
	m_Gauge->SetSize(rect.x + 2, rect.y + 2, rect.width - 4, rect.height - 4);
	m_Gauge->Show();
}

///////////////////////////////////////////////////////////////////////////////
// Resize Event
///////////////////////////////////////////////////////////////////////////////

void mdProgressStatusBar::OnSize(wxSizeEvent& event)
{
	SendSizeEvent();	
	event.Skip();
}

///////////////////////////////////////////////////////////////////////////////